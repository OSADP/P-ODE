<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans-4.0.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd">

    <context:component-scan base-package="com.leidos.ode.emulator"/>

    <bean id="propertyPlaceholderConfigurer"
          class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="locations">
            <list>
                <value>classpath:META-INF/EmulatorContext-Dev.properties</value>
            </list>
        </property>
        <!-- This means don't blow up if a property is not set -->
        <property name="ignoreUnresolvablePlaceholders" value="true"/>
        <!--
        This means that any system properties set on the command line will take precedence over those set locally or in a properties file.
        -->
        <property name="systemPropertiesModeName" value="SYSTEM_PROPERTIES_MODE_OVERRIDE"/>
    </bean>

    <bean id="dateFormat" class="java.text.SimpleDateFormat">
        <constructor-arg value="MM-dd-YYYY"/>
    </bean>

    <bean id="ODELogger" class="com.leidos.ode.logging.ODELogger">
        <property name="mongoTemplate" ref="mongoTemplate"/>
    </bean>

    <bean id="SubscribeODEAgent" class="com.leidos.ode.agent.BasicODEAgent"/>

    <bean id="PublishODEAgent" class="com.leidos.ode.agent.PublishODEAgent"/>

    <bean id="PushDataSource" class="com.leidos.ode.collector.datasource.PushDataSource" abstract="true"/>

    <bean id="VDOTParser" class="com.leidos.ode.agent.parser.VDOTParser"/>

    <bean id="PassthroughSanitizer" class="com.leidos.ode.agent.sanitizer.PassthroughSanitizer"/>

    <bean id="RITISParser" class="com.leidos.ode.agent.parser.RITISParser"/>

    <bean id="BSMParser" class="com.leidos.ode.agent.parser.BSMParser"/>

    <bean id="mongo" class="com.mongodb.Mongo">
        <constructor-arg name="host" value="127.0.0.1"/>
        <constructor-arg name="port" value="27017"/>
    </bean>

    <!-- Define the MongoTemplate which handles connectivity with MongoDB -->
    <bean id="mongoTemplate" class="org.springframework.data.mongodb.core.MongoTemplate">
        <constructor-arg name="mongo" ref="mongo"/>
        <constructor-arg name="databaseName" value="ode"/>
    </bean>

    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~VDOT Beans~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <bean id="VDOTWeatherRegistrationInfo" class="com.leidos.ode.core.registration.RegistrationInformation">
        <property name="messageType" value="${leidos.ode.emulator.vdotweather.messageType}"/>
        <property name="region" value="${leidos.ode.emulator.vdotweather.region}"/>
        <property name="registrationType" value="${leidos.ode.emulator.vdotweather.sub.registrationType}"/>
        <property name="agentId" value="${leidos.ode.emulator.vdotweather.sub.agentId}"/>
        <property name="subscriptionReceiveAddress" value="${leidos.ode.emulator.vdotweather.hostAddress}"/>
        <property name="subscriptionReceivePort" value="${leidos.ode.emulator.vdotweather.hostPort}"/>
        <property name="startDate">
            <bean factory-bean="dateFormat" factory-method="parse">
                <constructor-arg value="${leidos.ode.emulator.vdotweather.sub.startDate}"/>
            </bean>
        </property>
        <property name="endDate">
            <bean factory-bean="dateFormat" factory-method="parse">
                <constructor-arg value="${leidos.ode.emulator.vdotweather.sub.endDate}"/>
            </bean>
        </property>
    </bean>

    <bean id="VDOTWeatherDataSource" class="com.leidos.ode.collector.datasource.UDPPushDataSource"
          parent="PushDataSource">
        <property name="hostProtocol" value="${leidos.ode.emulator.vdotweather.hostProtocol}"/>
        <property name="hostAddress" value="${leidos.ode.emulator.vdotweather.hostAddress}"/>
        <property name="hostPort" value="${leidos.ode.emulator.vdotweather.hostPort}"/>
    </bean>

    <bean id="VDOTWeatherSubRegistration" class="com.leidos.ode.agent.registration.BasicODERegistration">
        <property name="registrationBaseUrl" value="${leidos.ode.reg.baseurl}"/>
        <property name="registrationEndpoint" value="${leidos.ode.reg.sub.endpoint}"/>
    </bean>

    <bean id="VDOTWeatherDataTarget" class="com.leidos.ode.emulator.agent.EmulatorDataTarget">
        <property name="messageType" value="${leidos.ode.emulator.vdotweather.datatarget.messageType}"/>
    </bean>

    <bean id="VDOTWeatherSubAgent" parent="SubscribeODEAgent">
        <property name="registration" ref="VDOTWeatherSubRegistration"/>
        <property name="parser" ref="VDOTParser"/>
        <property name="sanitizer" ref="PassthroughSanitizer"/>
        <property name="dataTarget" ref="VDOTWeatherDataTarget"/>
        <property name="registrationInformation" ref="VDOTWeatherRegistrationInfo"/>
        <property name="odeLogger" ref="ODELogger"/>
    </bean>

    <bean id="VDOTWeatherCollector" class="com.leidos.ode.collector.ODECollector">
        <property name="agent" ref="VDOTWeatherSubAgent"/>
        <property name="dataSource" ref="VDOTWeatherDataSource"/>
    </bean>

    <bean id="VDOTSpeedRegistrationInfo" class="com.leidos.ode.core.registration.RegistrationInformation">
        <property name="messageType" value="${leidos.ode.emulator.vdotspeed.messageType}"/>
        <property name="region" value="${leidos.ode.emulator.vdotspeed.region}"/>
        <property name="registrationType" value="${leidos.ode.emulator.vdotspeed.sub.registrationType}"/>
        <property name="agentId" value="${leidos.ode.emulator.vdotspeed.sub.agentId}"/>
        <property name="subscriptionReceiveAddress" value="${leidos.ode.emulator.vdotspeed.hostAddress}"/>
        <property name="subscriptionReceivePort" value="${leidos.ode.emulator.vdotspeed.hostPort}"/>
        <property name="startDate">
            <bean factory-bean="dateFormat" factory-method="parse">
                <constructor-arg value="${leidos.ode.emulator.vdotspeed.sub.startDate}"/>
            </bean>
        </property>
        <property name="endDate">
            <bean factory-bean="dateFormat" factory-method="parse">
                <constructor-arg value="${leidos.ode.emulator.vdotspeed.sub.endDate}"/>
            </bean>
        </property>
    </bean>

    <bean id="VDOTSpeedDataSource" class="com.leidos.ode.collector.datasource.UDPPushDataSource"
          parent="PushDataSource">
        <property name="hostProtocol" value="${leidos.ode.emulator.vdotspeed.hostProtocol}"/>
        <property name="hostAddress" value="${leidos.ode.emulator.vdotspeed.hostAddress}"/>
        <property name="hostPort" value="${leidos.ode.emulator.vdotspeed.hostPort}"/>
    </bean>

    <bean id="VDOTSpeedSubRegistration" class="com.leidos.ode.agent.registration.BasicODERegistration">
        <property name="registrationBaseUrl" value="${leidos.ode.reg.baseurl}"/>
        <property name="registrationEndpoint" value="${leidos.ode.reg.sub.endpoint}"/>
    </bean>

    <bean id="VDOTSpeedDataTarget" class="com.leidos.ode.emulator.agent.EmulatorDataTarget">
        <property name="messageType" value="${leidos.ode.emulator.vdotspeed.datatarget.messageType}"/>
    </bean>

    <bean id="VDOTSpeedSubAgent" parent="SubscribeODEAgent">
        <property name="registration" ref="VDOTSpeedSubRegistration"/>
        <property name="parser" ref="VDOTParser"/>
        <property name="sanitizer" ref="PassthroughSanitizer"/>
        <property name="dataTarget" ref="VDOTSpeedDataTarget"/>
        <property name="registrationInformation" ref="VDOTSpeedRegistrationInfo"/>
    </bean>

    <bean id="VDOTSpeedCollector" class="com.leidos.ode.collector.ODECollector">
        <property name="agent" ref="VDOTSpeedSubAgent"/>
        <property name="dataSource" ref="VDOTSpeedDataSource"/>
    </bean>

    <bean id="VDOTTravelRegistrationInfo" class="com.leidos.ode.core.registration.RegistrationInformation">
        <property name="messageType" value="${leidos.ode.emulator.vdottravel.messageType}"/>
        <property name="region" value="${leidos.ode.emulator.vdottravel.region}"/>
        <property name="registrationType" value="${leidos.ode.emulator.vdottravel.sub.registrationType}"/>
        <property name="agentId" value="${leidos.ode.emulator.vdottravel.sub.agentId}"/>
        <property name="subscriptionReceiveAddress" value="${leidos.ode.emulator.vdottravel.hostAddress}"/>
        <property name="subscriptionReceivePort" value="${leidos.ode.emulator.vdottravel.hostPort}"/>
        <property name="startDate">
            <bean factory-bean="dateFormat" factory-method="parse">
                <constructor-arg value="${leidos.ode.emulator.vdottravel.sub.startDate}"/>
            </bean>
        </property>
        <property name="endDate">
            <bean factory-bean="dateFormat" factory-method="parse">
                <constructor-arg value="${leidos.ode.emulator.vdottravel.sub.endDate}"/>
            </bean>
        </property>
    </bean>

    <bean id="VDOTTravelDataSource" class="com.leidos.ode.collector.datasource.UDPPushDataSource"
          parent="PushDataSource">
        <property name="hostProtocol" value="${leidos.ode.emulator.vdottravel.hostProtocol}"/>
        <property name="hostAddress" value="${leidos.ode.emulator.vdottravel.hostAddress}"/>
        <property name="hostPort" value="${leidos.ode.emulator.vdottravel.hostPort}"/>
    </bean>

    <bean id="VDOTTravelSubRegistration" class="com.leidos.ode.agent.registration.BasicODERegistration">
        <property name="registrationBaseUrl" value="${leidos.ode.reg.baseurl}"/>
        <property name="registrationEndpoint" value="${leidos.ode.reg.sub.endpoint}"/>
    </bean>

    <bean id="VDOTTravelDataTarget" class="com.leidos.ode.emulator.agent.EmulatorDataTarget">
        <property name="messageType" value="${leidos.ode.emulator.vdottravel.datatarget.messageType}"/>
    </bean>

    <bean id="VDOTTravelSubAgent" parent="SubscribeODEAgent">
        <property name="registration" ref="VDOTTravelSubRegistration"/>
        <property name="parser" ref="VDOTParser"/>
        <property name="sanitizer" ref="PassthroughSanitizer"/>
        <property name="dataTarget" ref="VDOTTravelDataTarget"/>
        <property name="registrationInformation" ref="VDOTTravelRegistrationInfo"/>
        <property name="odeLogger" ref="ODELogger"/>
    </bean>

    <bean id="VDOTTravelCollector" class="com.leidos.ode.collector.ODECollector">
        <property name="agent" ref="VDOTTravelSubAgent"/>
        <property name="dataSource" ref="VDOTTravelDataSource"/>
    </bean>

    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~RITIS Beans~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <bean id="RITISSpeedRegistrationInfo" class="com.leidos.ode.core.registration.RegistrationInformation">
        <property name="messageType" value="${leidos.ode.emulator.ritisspeed.messageType}"/>
        <property name="region" value="${leidos.ode.emulator.ritisspeed.region}"/>
        <property name="registrationType" value="${leidos.ode.emulator.ritisspeed.sub.registrationType}"/>
        <property name="agentId" value="${leidos.ode.emulator.ritisspeed.sub.agentId}"/>
        <property name="subscriptionReceiveAddress" value="${leidos.ode.emulator.ritisspeed.hostAddress}"/>
        <property name="subscriptionReceivePort" value="${leidos.ode.emulator.ritisspeed.hostPort}"/>
        <property name="startDate">
            <bean factory-bean="dateFormat" factory-method="parse">
                <constructor-arg value="${leidos.ode.emulator.ritisspeed.sub.startDate}"/>
            </bean>
        </property>
        <property name="endDate">
            <bean factory-bean="dateFormat" factory-method="parse">
                <constructor-arg value="${leidos.ode.emulator.ritisspeed.sub.endDate}"/>
            </bean>
        </property>
    </bean>

    <bean id="RITISSpeedDataSource" class="com.leidos.ode.collector.datasource.UDPPushDataSource"
          parent="PushDataSource">
        <property name="hostProtocol" value="${leidos.ode.emulator.ritisspeed.hostProtocol}"/>
        <property name="hostAddress" value="${leidos.ode.emulator.ritisspeed.hostAddress}"/>
        <property name="hostPort" value="${leidos.ode.emulator.ritisspeed.hostPort}"/>
    </bean>

    <bean id="RITISSpeedSubRegistration" class="com.leidos.ode.agent.registration.BasicODERegistration">
        <property name="registrationBaseUrl" value="${leidos.ode.reg.baseurl}"/>
        <property name="registrationEndpoint" value="${leidos.ode.reg.sub.endpoint}"/>
    </bean>

    <bean id="RITISSpeedDataTarget" class="com.leidos.ode.emulator.agent.EmulatorDataTarget">
        <property name="messageType" value="${leidos.ode.emulator.ritisspeed.datatarget.messageType}"/>
    </bean>

    <bean id="RITISSpeedSubAgent" parent="SubscribeODEAgent">
        <property name="registration" ref="RITISSpeedSubRegistration"/>
        <property name="parser" ref="RITISParser"/>
        <property name="sanitizer" ref="PassthroughSanitizer"/>
        <property name="dataTarget" ref="RITISSpeedDataTarget"/>
        <property name="registrationInformation" ref="RITISSpeedRegistrationInfo"/>
        <property name="odeLogger" ref="ODELogger"/>
    </bean>

    <bean id="RITISSpeedCollector" class="com.leidos.ode.collector.ODECollector">
        <property name="agent" ref="RITISSpeedSubAgent"/>
        <property name="dataSource" ref="RITISSpeedDataSource"/>
    </bean>

    <bean id="RITISWeatherRegistrationInfo" class="com.leidos.ode.core.registration.RegistrationInformation">
        <property name="messageType" value="${leidos.ode.emulator.ritisweather.messageType}"/>
        <property name="region" value="${leidos.ode.emulator.ritisweather.region}"/>
        <property name="registrationType" value="${leidos.ode.emulator.ritisweather.sub.registrationType}"/>
        <property name="agentId" value="${leidos.ode.emulator.ritisweather.sub.agentId}"/>
        <property name="subscriptionReceiveAddress" value="${leidos.ode.emulator.ritisweather.hostAddress}"/>
        <property name="subscriptionReceivePort" value="${leidos.ode.emulator.ritisweather.hostPort}"/>
        <property name="startDate">
            <bean factory-bean="dateFormat" factory-method="parse">
                <constructor-arg value="${leidos.ode.emulator.ritisweather.sub.startDate}"/>
            </bean>
        </property>
        <property name="endDate">
            <bean factory-bean="dateFormat" factory-method="parse">
                <constructor-arg value="${leidos.ode.emulator.ritisweather.sub.endDate}"/>
            </bean>
        </property>
    </bean>

    <bean id="RITISWeatherDataSource" class="com.leidos.ode.collector.datasource.UDPPushDataSource"
          parent="PushDataSource">
        <property name="hostProtocol" value="${leidos.ode.emulator.ritisweather.hostProtocol}"/>
        <property name="hostAddress" value="${leidos.ode.emulator.ritisweather.hostAddress}"/>
        <property name="hostPort" value="${leidos.ode.emulator.ritisweather.hostPort}"/>
    </bean>

    <bean id="RITISWeatherSubRegistration" class="com.leidos.ode.agent.registration.BasicODERegistration">
        <property name="registrationBaseUrl" value="${leidos.ode.reg.baseurl}"/>
        <property name="registrationEndpoint" value="${leidos.ode.reg.sub.endpoint}"/>
    </bean>

    <bean id="RITISWeatherDataTarget" class="com.leidos.ode.emulator.agent.EmulatorDataTarget">
        <property name="messageType" value="${leidos.ode.emulator.ritisweather.datatarget.messageType}"/>
    </bean>

    <bean id="RITISWeatherSubAgent" parent="SubscribeODEAgent">
        <property name="registration" ref="RITISWeatherSubRegistration"/>
        <property name="parser" ref="RITISParser"/>
        <property name="sanitizer" ref="PassthroughSanitizer"/>
        <property name="dataTarget" ref="RITISWeatherDataTarget"/>
        <property name="registrationInformation" ref="RITISWeatherRegistrationInfo"/>
        <property name="odeLogger" ref="ODELogger"/>
    </bean>

    <bean id="RITISWeatherCollector" class="com.leidos.ode.collector.ODECollector">
        <property name="agent" ref="RITISWeatherSubAgent"/>
        <property name="dataSource" ref="RITISWeatherDataSource"/>
    </bean>

    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~BSM Beans~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <bean id="BSMRegistrationInfo" class="com.leidos.ode.core.registration.RegistrationInformation">
        <property name="messageType" value="${leidos.ode.emulator.bsm.messageType}"/>
        <property name="region" value="${leidos.ode.emulator.bsm.region}"/>
        <property name="registrationType" value="${leidos.ode.emulator.bsm.sub.registrationType}"/>
        <property name="agentId" value="${leidos.ode.emulator.bsm.sub.agentId}"/>
        <property name="subscriptionReceiveAddress" value="${leidos.ode.emulator.bsm.hostAddress}"/>
        <property name="subscriptionReceivePort" value="${leidos.ode.emulator.bsm.hostPort}"/>
        <property name="startDate">
            <bean factory-bean="dateFormat" factory-method="parse">
                <constructor-arg value="${leidos.ode.emulator.bsm.sub.startDate}"/>
            </bean>
        </property>
        <property name="endDate">
            <bean factory-bean="dateFormat" factory-method="parse">
                <constructor-arg value="${leidos.ode.emulator.bsm.sub.endDate}"/>
            </bean>
        </property>
    </bean>

    <bean id="BSMDataSource" class="com.leidos.ode.collector.datasource.UDPPushDataSource" parent="PushDataSource">
        <property name="hostProtocol" value="${leidos.ode.emulator.bsm.hostProtocol}"/>
        <property name="hostAddress" value="${leidos.ode.emulator.bsm.hostAddress}"/>
        <property name="hostPort" value="${leidos.ode.emulator.bsm.hostPort}"/>
    </bean>

    <bean id="BSMSubRegistration" class="com.leidos.ode.agent.registration.BasicODERegistration">
        <property name="registrationBaseUrl" value="${leidos.ode.reg.baseurl}"/>
        <property name="registrationEndpoint" value="${leidos.ode.reg.sub.endpoint}"/>
    </bean>

    <bean id="BSMDataTarget" class="com.leidos.ode.emulator.agent.EmulatorDataTarget">
        <property name="messageType" value="${leidos.ode.emulator.bsm.datatarget.messageType}"/>
    </bean>

    <bean id="BSMSubAgent" parent="SubscribeODEAgent">
        <property name="registration" ref="BSMSubRegistration"/>
        <property name="parser" ref="BSMParser"/>
        <property name="sanitizer" ref="PassthroughSanitizer"/>
        <property name="dataTarget" ref="BSMDataTarget"/>
        <property name="registrationInformation" ref="BSMRegistrationInfo"/>
        <property name="odeLogger" ref="ODELogger"/>
    </bean>

    <bean id="BSMCollector" class="com.leidos.ode.collector.ODECollector">
        <property name="agent" ref="BSMSubAgent"/>
        <property name="dataSource" ref="BSMDataSource"/>
    </bean>
</beans>